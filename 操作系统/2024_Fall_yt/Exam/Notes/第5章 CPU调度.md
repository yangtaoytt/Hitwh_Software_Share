### 第5章 CPU 调度

[TOC]

#### 1. 什么是多道程序操作系统的基础？
**CPU 调度**是多道程序操作系统的基础。

#### 2. 多道程序的目的？
多道程序的目的是使 **CPU 的使用率最大化**。

#### 3. 进程执行的组成？
一个进程的执行由 **CPU 执行（CPU 区间）**和 **I/O 等待（I/O 区间）**组成，进程在执行过程中不断在这两个状态之间**切换**。

#### 4. 进程的区间特征？
1. 进程一般由**大**量的**短 CPU 区间**（<8ms）和**少**量的**长 CPU 区间**组成。
2. **I/O** 为主的程序里**短 CPU** 区间较多。
3. **CPU** 为主的程序里**长 CPU** 区间较少。

#### 5. 调度程序的作用？
每当 CPU 空闲时，**调度程序**（短期调度程序）从**就绪队列**中选择一个进程，并为之分配 CPU。

#### 6. CPU 调度的时机？
1. 从**运行**状态转换成**等待**状态（如发生 I/O）。
2. 从**运行**状态转换成**就绪**状态（如发生中断）。
3. 从**等待**状态转换成**就绪**状态（I/O 完成）。
4. 进程**终止**。
5. 进程进入**就绪**队列。

#### 7. 调度分类和分类依据？
1. **非抢占调度**：一旦把 CPU 分配给一个进程，直到**该进程结束**之前，不能把 CPU 分配给其他进程。
2. **抢占调度**：进程在执行过程中，可以被其他进程**抢占 CPU 使用权**。

#### 8. 分派程序的作用？
分派程序是一个模块，用来将 CPU 的控制交给**由短期调度程序选择的进程**。功能包括：
1. 切换**上下文**（context switch）。
2. 切换**到模式**。
3. 跳转到用户程序的**合适位置**，以重新启动程序。

#### 9. 分派延迟的定义？
分派程序**停止一个进程**而**启动另一个进程**所要花的时间称为分派延迟。

#### 10. CPU 调度五大准则？
1. **CPU 使用率**：需要使 CPU 尽可能忙。
2. **吞吐量**：在一个时间单元内所完成的进程数量。
3. **周转时间**：从进程提交到进程完成的时间段。
4. **等待时间**：进程在就绪队列中等待的时间。
5. **响应时间**：从提交请求到产生第一响应的时间。

#### 11. CPU 调度算法有哪些？
1. 先到先服务调度（First Come, First Service Scheduling，**FCFS**）。
2. 最短作业优先调度（Shortest Job First Scheduling，**SJF**）。
3. 优先级调度（Priority Scheduling）。
4. 轮转法调度（Round Robin Scheduling，**RR**）。
5. 多级队列调度（Multilevel Queue Scheduling）。
6. 多级反馈队列调度（Multilevel Feedback Queue Scheduling）。

#### 12. FCFS 定义？
先请求 CPU 的进程先分配 CPU，**非抢占式**调度。

#### 13. 什么是护航效果？
护航效果（convoy effect）是指**所有其他小进程都等待**一个大进程释放 CPU，即**短进程**跟在**长进程**后面。

#### 14. 护航效果的后果？
1. 大进程运行 CPU 区间时，其他短进程很快完成 I/O 操作并移到就绪队列等待分配 CPU（**I/O 设备空闲**）。
2. 大进程释放 CPU 后移到 I/O 队列，其他短进程很快完成 CPU 操作并移到 I/O 队列（**CPU 空闲**）。

#### 15. SJF 定义？
选择 CPU 区间长度最短的进程，分为**非抢占调度**和**抢占调度**。

#### 16. 什么调度算法是最优算法？
对于给定的一组进程，在平均等待时间上，**最短作业优先调度**算法是最优算法。

#### 17. SJF 的问题？
预先知道下一个 CPU 区间长度（**remaining execution time**）**具有难度**。

#### 18. 优先级调度的定义？
每个进程都有其优先级，通常用数字表示，数字越小优先级越高，分为**非抢占式**和**抢占式**优先级调度。

#### 19. SJF 是优先级调度算法吗？
SJF 是优先级调度算法，一个进程的优先级与**其下一个 CPU 区间长度**成反比。

#### 20. 优先级调度的问题？
低优先级进程无法运行（**饥饿**或**无限阻塞**）。

#### 21. 优先级调度问题的解决办法？
**老化（aging）**：随着**等待时间的增加**，逐渐**提高进程的优先级**。

#### 22. RR 的定义？
1. 是 FCFS 调度算法的变种，给每个进程分配一个**时间片**（time slice）。
2. 系统每隔一个时间片**发出时钟中断**，调度另一个进程执行。
3. 如果进程提前结束，发生中断并**调度另一个进程**。

#### 23. 如何确定时间片长度？
1. **找权衡**：
   - 时间片太大，与 **FCFS** 相同。
   - 时间片太小，**上下文切换负载**过重。
2. 通常，如果绝大多数进程能在**一个时间片内完成**，则平均周转事件较好。
3. 时间片应大于 **80% 的 CPU 区间**。

#### 24. 什么是 Anomal 现象？
**周转时间**并未随着**时间片大小的增加**而改善。

#### 25. 多级队列调度的定义？
1. 将线程分成多个独立队列，每个队列有**自己的调度算法**。
2. 队列内采用一种调度机制，**队列之间**采用另一种调度机制：
   - **固定优先级**抢占调度。
   - 队列之间**划分时间片**。

#### 26. 固定优先级调度的优势和劣势？
1. **优势**：**高优先级**任务先执行。
2. **劣势**：缺乏灵活性，可能导致**饥饿**。

#### 27. 老化在多级队列中如何体现？
通过进程在**队列间的移动**实现老化（aging）。

#### 28. 处理器分类？
1. **同构处理器（Homogeneous）**：处理器**功能和结构**相同。
2. **异构处理器（Heterogeneous）**：处理器**功能和结构**不同。

#### 29. 多处理器调度的分类？
1. **对称多处理（SMP）**：每个处理器**有自己的调度算法**，**不允许**处理器之间的任务移动。
2. **非对称多处理（Asymmetric）**：一个处理器**负责调度任务**，**允许**处理器之间的任务移动。

#### 30. 处理器亲和性及其分类？
1. **软亲和性**：**允许**处理器之间的任务移动。
2. **硬亲和性**：**不允许**处理器之间的任务移动。

#### 31. 负载平衡的目的和定义？
在 SMP 系统中，通过保持**所有处理器的工作负载平衡**，实现**平均分配工作**。

#### 32. 负载平衡方式分类？
1. **推移迁移（push migration）**：周期性检查处理器负载，若不平衡则将任务从过载处理器**推送到空闲或轻负载处理器**。
2. **拉取迁移（pull migration）**：空闲处理器**从繁忙处理器拉取任务**。

#### 33. 两种线程调度分类？
1. **Local Scheduling**：
   - **线程库**调度用户级线程到有效的轻量级进程（LWP）。
   - 竞争范围为**同一进程内线程**之间。
2. **Global Scheduling**：
   - **系统**调度内核线程到物理处理器上。
   - 竞争范围为**系统所有线程**。

#### 34. 实时任务的定义？
实时系统中的进程具有**截止时间**要求，需在给定的截止时间内完成执行。

#### 35. 实时系统分类？
1. **硬实时系统（Hard Real-Time Systems）**：
   - 具有硬截止时间，任务**必须**在截止时间内结束。
   - 如军用设备、医疗设备。
2. **软实时系统（Soft Real-Time Systems）**：
   - 具有软截止时间，任务**可以**适当超过截止时间结束。
   - 如音频、视频系统。

#### 36. 调度中任务的类别

1. **Periodic Tasks (周期性任务)**: The task is released **periodically**.
2. **Aperiodic Tasks (非周期性任务)**: Is **not** released **periodically**, **no deadline**, so the response time is the performance index.
3. **Sporadic Tasks (零星任务)**: Is **not** released **periodically**, but is released within a given time interval, and has a **deadline**.

#### 37. 实时调度算法影响因素？
1. Rate Monotonic，**经常发生**的优先级上调。
2. Earliest Deadline First，**着急**的任务优先。
3. Earliest Deadline Zero Laxity，**松弛时间越少**越优先。

