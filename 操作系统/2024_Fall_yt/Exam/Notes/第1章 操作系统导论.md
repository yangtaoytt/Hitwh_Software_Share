### 第一章 操作系统导论

[TOC]


#### 1. OS是什么？

操作系统是**计算机用户**和**计算机硬件**之间运行的一个程序。

#### 2. OS的工作内容是什么？

1. **资源管理服务**：资源包括**硬件**资源和**软件**资源。硬件资源如CPU、内存、硬盘、键盘等；软件资源如MS Office、eClipse、VS。
2. **为用户提供服务**：**交互**、提供程序的**运行环境**等，主要是为了方便用户使用。

#### 3. OS是硬件还是软件？

操作系统是**最接近硬件的一层软件**。

#### 4. OS的目标是什么？

1. 通过运行计算机的应用程序，**方便用户解决问题**。
2. **方便用户操作使用计算机**。
3. 有效使用**计算机硬件资源**。

#### 5. OS定义

1. 操作系统是一直运行在计算机上的程序，通常狭义上被称为**内核程序**（Kernel），其他程序为**系统程序**和**应用程序**。
2. 操作系统是**资源管理平台**、**运行程序的平台**，也是**为用户提供服务的平台**。
3. **WIKI定义**: An **operating system (OS)** is system software that manages computer hardware and software resources, and provides common services for computer programs.

#### 6. 计算机系统的结构是什么？

计算机系统是层级结构，主要包括以下部分：

1. **硬件**：提供最基本的计算资源，如CPU、内存、I/O设备等。
2. **操作系统**：协调控制多个应用及其对硬件的使用。
3. **应用程序**：为解决用户问题，定义了解决方法的程序，如文字编辑器、浏览器、游戏、数据库。
4. **用户**：人、设备、其他计算机系统。

#### 7. 计算机系统的组织是什么？

1. 单个或多个中央处理器通过总线与内存和设备控制器相连。
2. 或者：**启动**、**中断**、**I/O结构**、**存储结构**。

#### 8. 计算机系统如何启动？

1. 通电。
2. **主板自检**。
3. 运行**BIOS**（Basic Input Output System）。
4. 确认每个设备是否工作正常，确认无误后运行位于ROM或EEROM的**Bootstrap**程序。

#### 9. 引导程序的工作内容包括什么？

1. 初始化设备。
2. 把OS加载到内存中。
3. 运行第一个进程Init()，等待事件发生。

#### 10. 事件触发由什么技术实现？

1. 一个事件的触发是通过**软件**或者**硬件**中断来实现的。
2. 在实现操作系统功能时，中断是一个非常重要的实现机制。

#### 11. 中断分为哪几类？

1. **软中断**：通过**软件**触发中断。**系统调用**会触发软件中断，如异常、除零，不可被屏蔽。
2. **硬中断**：**硬件**通过向CPU发送信号来触发，对一般用户**透明**，但可以触发程序运行，如网卡接收数据包，可以被屏蔽。

#### 12. 中断后，OS如何处理？

1. 系统一旦发生中断，CPU会运行**中断服务程序**（ISR）。
2. 系统通过**中断向量表**管理**中断请求**与**中断服务程序**的对应关系，其中包含所有服务程序的地址。

#### 13. 举例几种来源不同的中断。

1. **I/O**设备发生的事件，如按键盘、点击鼠标、磁盘的读写等。
2. **异常事件**、**重要事件**的发生，如断电、部件失灵等。
3. **非法指令**，如除零、下达不存在的指令等。

#### 14. 中断的工作流程

1. 保存当前进程的**程序计数器PC**（Program Counter）。
2. 跳转到相应的**中断服务程序**中，运行相应的中断服务程序。
3. 中断服务程序运行结束后，返回到**被中断的程序**并继续运行，或转到操作系统**指定的程序**中。

#### 15. 现代OS被视为什么的系统？

现代操作系统一般被视为以**中断驱动**（Interrupt-Driven）或**事件驱动**（Event-Driven）的系统。

#### 16. C语言中如何规定外部设备的标准输入输出及错误？

规定在标准库`stdio.h`中，其中有三种文件标识符：

1. 标准输入：`#define stdin __create_file(0)`。
2. 标准输出：`#define stdout __create_file(1)`。
3. 标准错误：`#define stderr __create_file(2)`。

#### 17. OS内I/O的结构是怎样的？

1. I/O设备与CPU可**同时**运行。
2. CPU负责**内存**与**本地缓冲器**之间的数据传递。
3. 设备控制器负责在**所控制的外部设备**与**本地缓冲存储**之间进行数据传递。每个设备控制器负责特定类型的设备（如磁盘控制器负责磁盘），并拥有自己的**本地缓冲器（buffer）**和**寄存器**。
4. I/O操作结束后，设备控制器通过**中断**通知CPU表示I/O结束。

#### 18. 传统磁盘I/O的工作流程及其问题

**工作流程**：

1. 传输单位为**字节**。
2. CPU和磁盘控制器都只有**小容量**的寄存器传输数据。
3. 磁盘控制器每次传输数据时，通过**中断**通知CPU表示I/O结束。
   **问题**：大量时间处理I/O，导致CPU利用率低。

#### 19. DMA的定义和特点

**定义**：DMA（Direct Memory Access）直接访问内存在专用硬件控制下，实现**高速外部设备**与**主存储器**之间的批量数据交换，减少CPU干预的I/O操作方式。
**特点**：

1. DMA控制器在没有CPU干涉的情况下，以**块（Block）**为单位，负责设备缓冲器与主存之间的数据传送。
2. 传统磁盘I/O是每个字节传送完成后触发中断，而DMA是每完成**块**传送后触发中断。
3. 有利于高速I/O设备传送数据，接近内存速度。

#### 19.5 DMA举例

...

#### 20. I/O操作分为哪几种？

1. **同步操作**：**I/O结束后**，用户程序才能获得控制权，I/O期间用户程序无法运行。
2. **异步操作**：**I/O未结束时**，用户程序即可获得控制权，I/O期间用户程序可继续运行。

#### 21. 存储设备分级

1. **寄存器**：包括**指令**寄存器、数据寄存器。
2. **一级存储设备**：指**内存**，是CPU唯一可直接**随机访问**的**大**容量存储设备，是易失性存储设备（断电后数据丢失）。
3. **二级存储设备**：指非易失性设备，如磁盘。

#### 22. 一张磁盘表面如何划分？

一张磁盘表面划分为多个**磁道**，每个磁道可以划分为**扇区**。

#### 23. 磁盘控制器有何作用？

磁盘控制器负责**设备**和**计算机**之间的逻辑交互。

#### 24. 闪存的特点？分为哪几种？

1. **特点**：闪存是芯片级别的移动存储设备。
2. **分类**：
   - **Nand Flash**：速度慢寿命长。
   - **Nor Flash**：速度快寿命短。

#### 25. 固态硬盘的特点？

固态硬盘比磁盘速度快，基于**NAND Flash**集成而来。

#### 26. 存储设备划分层级标准是什么？都有哪些层级？

1. **划分标准**：根据**速度、价格、易失性**。
2. **层级**：
   - 寄存器。
   - Cache。
   - 主存。
   - 固态硬盘。
   - 磁盘。
   - 光盘。
   - 磁带。

#### 27. 处理器系统可以分为哪几种？

1. **单**处理器系统。
2. **多**处理器系统。
3. 集群系统。

#### 28. 单处理器系统是什么？

1. 系统中只有一个**通用处理器**，处理来自用户进程的指令。
2. 通用处理器可能会集成**专用处理器**功能。
3. 还包括**其他专用处理器**（如磁盘控制器、显卡），专用处理器一般不接受用户指令，只受系统控制。

#### 29. 多处理器系统是什么？

1. 系统中有**多个处理器**，又称并联系统，多个处理器共享**一个内存**，CPU之间通过**共享内存**通讯。
2. 操作系统可以运行在某**一个**CPU或**多个**CPU上。

#### 30. 多处理器系统的优点

1. 增加吞吐量。
2. 方便扩展。
3. 提高可靠性。

#### 31. 多处理器系统的分类

1. **异构多处理器**（非对称处理器）：
   - 处理器在结构上不同。
   - 一个处理器负责运行OS，其他处理器运行其他程序，处理器之间构成**主从**关系。
2. **同构多处理器**（对称处理器）：
   - 处理器结构相同。
   - OS可运行在任意处理器上，处理器间**无主从**关系。

#### 32. 多核处理器定义

一个处理器上有多个CPU，即多个处理器集成到一个芯片上，可以是对称多处理器，也可以是非对称多处理器。

#### 33. 为什么多处理器环境下不管多处理器还是多核处理器都要有自己的寄存器和Cache？

**为了便于各个CPU能够将计算中的临时数据独立保存，并行独立运行，提高速度。**

#### 34. 集群系统是什么？

1. 集群系统是多个AS协同工作。
2. AS指的是各计算机系统（节点）都有自己独立OS的系统。
3. 一个集群系统可以看成单个逻辑计算单元，由节点通过网络连接组成。

#### 35. 集群系统的优点和缺点？

1. **优点**：
   - **高性能**：更快的处理速度、更大的存储容量、更好的数据完整性、更高的可靠性和广泛的可用资源。
2. **缺点**：
   - **高费用**：相比单机，需要更昂贵的实现和维护。

#### 36. 集群系统的分类

1. **非对称集群**：选出一个节点当主节点，构成**主从**关系。
2. **对称集群**：没有主节点，所有节点地位相等，**无主从**关系。

#### 37. OS按结构如何分类？

1. **批处理系统**（单道批处理）。
2. **多道程序系统**（多道批处理）。
3. **分时系统**（多任务系统）。

#### 38. 单道批处理系统的问题

当CPU发出I/O请求，设备进行I/O操作时，I/O操作相对于CPU速度很慢，会导致CPU空闲，而CPU是最昂贵的资源。

#### 39. 如何对单道批处理系统进行改进？改进后可能出现什么问题？

1. **改进方法**：
   - 系统进行I/O操作时，调度器选择另一个任务运行。
   - 需要调度器通过一定调度机制选择任务运行。
   - 为保障CPU总有任务运行（提高CPU使用率），多道程序系统需将多个任务载入内存供选择运行。
2. **问题**：
   - 如何确保响应时间，实现**公平使用CPU**？（多用户交互式系统对每个用户响应时间不能超过1秒）。
   - **解决办法**：
     - 使用分时系统或多任务系统，给每个任务赋予时间片，CPU在多个任务之间切换。

#### 40. 多道程序系统目的 VS 分时系统目的

1. **多道程序系统**：为提高**CPU的使用率**。
2. **分时系统**：为让每个任务能**公平使用CPU**，更体现公平性。

#### 41. 什么是批处理/多道/分时系统？各自的优缺点？

1. **批处理**：引入脱机输入/输出技术（外围机+磁带完成），由监督程序负责控制作业的输入、输出。
   - **优点**：
     - 缓解人机速度矛盾。
     - 提高资源利用率。
   - **缺点**：
     - 内存中仅能有一道程序运行，程序运行结束后才能调入下一道程序。
     - CPU大量时间空闲等待I/O完成，资源利用率低。
2. **多道**：内存中载入多道程序，在调度程序下交叉运行，共享资源。
   - **优点**：
     - 多道程序并发执行，共享资源。
     - 提高资源利用率，增加系统吞吐量。
   - **缺点**：
     - 用户响应时间长，无人机交互功能。
3. **分时**：计算机以时间片为单位轮流为各个用户/作业服务。
   - **优点**：
     - 用户请求可被即时响应，解决人机交互问题。
     - 允许多个用户同时使用一台计算机，相互独立。
   - **缺点**：
     - 不能优先处理紧急任务。
     - 对所有用户公平服务时间片，忽略任务紧急性。

#### 42. 为什么OS的操作需要一个保护机制？

1. OS可能被多个用户、多个程序共享。
2. 多用户、程序间可能互相影响。
3. 非法或不正确操作可能导致系统崩溃或破坏（如无限循环导致其他程序无法运行）。
   **总结**：为确保OS正确运行，需区分OS代码和用户代码执行。

#### 43. 保护机制是什么？通过什么区分？

1. **保护机制**：
   - 使用**硬件支持**的**双模式操作**，包括**用户模式**和**内核模式**（管理模式/特权模式/监督程序模式）。
   - 内核模式运行OS代码，用户模式运行用户代码。
2. **区分方式**：通过**模式位（PSW）**区分。

#### 44. 进程是什么？

1. 进程是**运行中的程序**，是系统的**运行单元**。
2. 系统中有多个进程在同时运行，运行在一个或多个CPU上，通过**复用CPU**并发运行。
3. 运行进程需分配一定资源（如CPU、内存、I/O设备、存储设备等），进程结束时需回收已分配资源。

#### 45. 进程和程序的区别

程序是**被动实体**，进程是**活动实体**。

#### 46. 进程管理包括什么？

进程管理包括以下内容：

- 进程的创建、执行和终止。
- 进程的调度和切换。
- 进程间的同步和通信。
- 资源的分配和回收。

#### 47. 内存管理的目的

内存管理的主要目的是**提高内存的使用率**，从而有效使用内存。

#### 48. 内存管理包括什么？

内存管理包括以下内容：

1. **数据**的存储。
2. **指令**的执行。

#### 49. 文件系统管理是什么？包括什么？

1. **文件系统管理**：为了便于使用计算机系统，操作系统提供了统一的逻辑信息存储视图。
2. **包括**：
   - 文件的存储和检索。
   - 文件的组织和保护。
   - 文件的分配和回收。

#### 50. 大容量存储系统是指？大容量存储系统管理包括什么？

1. **定义**：一般指二级存储设备，如硬盘。
2. **管理包括**：
   - 空闲空间管理。
   - 空间分配。
   - 硬盘调度。

#### 51. 高速缓存的作用？

1. 高速缓存是**临时存储设备**，一般设置在**高速设备**与**低速设备**之间。
2. 当高速设备（内存）从低速设备（磁盘）上读取数据时，会把数据**临时复制**到高速缓存上。
3. 如I/O操作开始进行时，操作系统**先到高速缓存**里查找。

#### 52. 缓存可以替代存储设备吗？缓存满了怎么办？

1. **缓存不能替代存储设备**，因为缓存速度快但容量小，而存储设备容量大且用于长期存储数据。
2. 缓存满了，系统会进行**置换**。

#### 53. 一致性问题用什么解决？

一致性问题通过**硬件**和**软件**解决。

#### 54. 简述IO流程，并说出在多处理器环境下有什么问题。

1. **IO流程**：
   - 先将数据从磁盘读入内存。
   - 复制数据到高速缓存。
   - 复制数据到寄存器。
   - 最后写入磁盘。
2. **问题**：在多处理器环境下，各存储器中的数据可能不一致，若**其他CPU**此时从内存读数据，可能会读到错误值。

#### 55. 解释术语：（1）缓冲（2）缓存（3）假脱机。

1. **缓冲**：为**传输数据**，暂时存储数据。
2. **缓存**：为**性能提高**，暂时存储数据。
3. **假脱机**：一种关于**低速字符设备**与**主机**交换信息的技术，又称外部设备联机并行操作。通过**实现虚拟设备共享**，提升I/O速度，但设备未被分配给特定任务。

#### 56. 云计算分类。

1. **公共云（Public）**：任何人都可以通过互联网支付使用。
2. **私有云（Private）**：由公司运营，仅供公司自己使用。
3. **混合云（Hybrid）**：包括公共云和私有云组件。

#### 57. 云计算三种服务。

1. **软件即服务 (SaaS)**：通过互联网提供一个或多个应用程序（如文字编辑器）。
2. **平台即服务 (PaaS)**：通过互联网使用的软件栈（如数据库服务器）。
3. **基础设施即服务 (IaaS)**：通过互联网提供的服务器或存储（如用于备份的存储）。